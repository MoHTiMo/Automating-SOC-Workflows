
Automating-SOC-Workflows

Project Overview
This project demonstrates the implementation of a Security Information and Event Management (SIEM) system using Wazuh integrated with The Hive for case management and Shuffle for SOAR (Security Orchestration, Automation, and Response) capabilities.

Tools Used:

Wazuh: SIEM and XDR
The Hive: Case management system
Shuffle: SOAR platform
VirusTotal API: Reputation check
1. Architecture Diagram
The diagram below shows the data flow across different components of the project.

Screenshot: Place the diagram here.
2. Setting Up Sysmon on Windows 10 VM
Sysmon was installed on a Windows 10 VM to generate relevant logs for analysis.

Steps:

Download Sysmon.
Install Sysmon to monitor system events.
Screenshot: Include the screenshot of Sysmon being downloaded here.

3. Wazuh Server Setup on Digital Ocean
Wazuh server was deployed on Ubuntu 22.04 using Digital Ocean as the cloud provider. A firewall was configured to control access, and the server was accessed via SSH.

Steps:

Setup Wazuh server on Digital Ocean.
Configure firewall rules to allow necessary traffic.
Download Wazuh on the server.
Access Wazuh GUI via the browser.
Screenshots:

Firewall rules (place here).
Accessing Wazuh server via SSH.
Wazuh download in the CLI.
Wazuh GUI login.
4. The Hive Server Setup on Digital Ocean
Similarly, The Hive was deployed on Ubuntu 22.04 on the same cloud provider. The installation included prerequisites such as Java, Cassandra, ElasticSearch, and finally The Hive.

Steps:

Set up Hive server.
Install prerequisites (Java, Cassandra, ElasticSearch).
Download and install The Hive.
Screenshots:

Completion of prerequisite installation.
(Optional) A separate file for detailed download instructions.
Hive running in CLI (status).
5. Adding an Agent to Wazuh
The Windows 10 VM (with Sysmon installed) was added as an agent to the Wazuh server for log ingestion and analysis.

Steps:

Execute PowerShell commands on the VM to register it as a Wazuh agent.
Confirm successful agent registration.
Screenshot: Place the screenshot of the PowerShell command here.

6. Detecting Mimikatz with Wazuh
Mimikatz, a credential extraction tool, was run on the Windows 10 VM to generate malicious activity. Wazuh successfully detected this activity and raised an alert.

Steps:

Download and run Mimikatz on the Windows VM.
Wazuh detects the malicious activity.
Screenshots:

Mimikatz running on Windows VM.
Wazuh GUI showing the Mimikatz detection.
7. Integrating Shuffle for SOAR Capabilities
Wazuh was integrated with Shuffle using a webhook. Shuffle received the Mimikatz detection alert and processed it further.

Steps:

Add Wazuh as a webhook in Shuffle.
Confirm that Shuffle received the detection alert.
Screenshot: Screenshot of Shuffle showing the received alert.

8. Using Shuffle for Automation
Shuffle was configured to extract the SHA256 hash from the Mimikatz alert using Regex. This hash was then sent to VirusTotal for a reputation check via the VirusTotal API.

Steps:

Configure Shuffle to extract SHA256 from the alert.
Add VirusTotal API to Shuffle for reputation checks.
Perform a reputation check on the file.
Screenshots:

Shuffle showing the VirusTotal API and the extracted SHA256 hash.
9. Sending Alerts to The Hive
Shuffle was configured to send alerts to The Hive using The Hive's API, where a case was automatically created for further investigation.

Steps:

Add The Hive API to Shuffle.
Send the alert details to The Hive and create a case.
Screenshot: Screenshot showing the created alert in The Hive.

10. Notifying SOC Analyst via Email
Finally, Shuffle was configured to send an email notification to a SOC analyst whenever an alert was detected and sent to The Hive.

Steps:

Configure Shuffle to send email alerts to the SOC analyst.
Ensure the email is received with alert details.
Screenshots:

Shuffle email configuration.
Email received by the SOC analyst.
Conclusion
This project showcases how to effectively integrate Wazuh with SOAR capabilities through Shuffle and use The Hive for case management. The implementation ensures seamless detection of malicious activity, automated responses, and effective case management.
